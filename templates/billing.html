<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="copyright" content="MACode ID, https://macodeid.com/">
  <title>අකුරු GEN</title>
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/titlelogo.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='maicons.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='vendor/animate/animate.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='theme.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='from.css') }}">
  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
</head>
<body>
  <!-- Back to top button -->
  <div class="back-to-top"></div>

  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky" data-offset="500">
      <div class="container">
        <a href="{{ url_for('home') }}" class="navbar-brand"><span class="text-primary">අකුරු </span> GEN</a>

        <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('home') }}">Home</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="{{ url_for('welcome') }}">Profile</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('subscribe') }}">Pricing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('login') }}">LogIn</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#about">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    
    <div class="container">
      <div class="page-banner">
        <div class="row justify-content-center align-items-center h-100">
          <div class="col-md-6">
            <nav aria-label="Breadcrumb">
              <ul class="breadcrumb justify-content-center py-0 bg-transparent">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active">Billing Address</li>
              </ul>
            </nav>
            <h1 class="text-center">Welcome {{ username }}.</h1>
            <!-- <span class="text-center">
                {% if 'username' in session %}
                  <p>You are registered as {{ username }}.</p>
                {% else %}
                  <p>Welcome! Please sign up to create an account.</p>
                {% endif %}
              </span> -->
            <span class="text-center">
                <p>Total Address : {{ billing_addresses_enum|length }}</p>
              </span>
          </div>
        </div>
      </div>
    </div>
  </header>


<!-- Main Content -->
<div class="page-section">
    <div class="container">
        <div class="row justify-content-center align-items-center h-100">
        <div class="col-md-6 wow fadeInUp">
            <h2 class="title-section">Set up your credit or debit card</h2>
            <div class="divider"></div>
            <form action="{{ url_for('add_billing') }}" method="post">
                <div class="form-group">
                    <label for="billing_address">Billing Address <span style="color: red;">*</span></label>
                    <textarea class="form-control" id="billing_address" name="billing_address" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="card_nickname">Card Name <span style="color: red;">*</span></label>
                    <input type="text" class="form-control" id="card_nickname" name="card_nickname" required>
                </div>
                <div class="form-group">
                    <label for="card_number">Card Number <span style="color: red;">*</span></label>
                    <div class="input-group position-relative">
                        <input type="text" class="form-control" id="card_number" name="card_number" required>
                        <div class="input-group-append">
                            <span class="input-group-text"><i id="card-icon"></i></span>
                        </div>
                        <div class="invalid-feedback" id="card-number-feedback"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="expiry_date">Expiry Date <span style="color: red;">*</span></label>
                    <div class="input-group position-relative">
                        <input type="text" class="form-control" id="expiry_date" name="expiry_date" placeholder="MM/YY" required>
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fas fa-check-circle text-success d-none"></i></span>
                        </div>
                        <div class="invalid-feedback" id="expiry-date-feedback"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cvv">CVV <span style="color: red;">*</span></label>
                    <div class="input-group position-relative">
                        <input type="text" class="form-control" id="cvv" name="cvv" required>
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fas fa-check-circle text-success d-none"></i></span>
                        </div>
                        <div class="invalid-feedback" id="cvv-feedback"></div>
                    </div>
                </div>       
            <div class="form-group submit-btn">
                <button type="submit" class="btn btn-primary">submit</button>
            </div>
          </form>
          </div>
        <div class="col-lg-6 py-3 wow fadeInRight">
            <div class="img-fluid py-3 text-center">
              <img src="{{ url_for('static', filename='img/about_frame.png') }}" alt="">
            </div>
          </div>
        </div>
    </div>
    </div> <!-- .container -->
</div> <!-- .page-section -->

<div class="page-section bg-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6 wow fadeInUp">
                <h2 class="title-section">{{ username }}'s Current Billing Addresses</h2>
                <div class="divider"></div>
                {% for index, billing_address in billing_addresses_enum %}
                <p><strong>Billing Address No:</strong> {{ index + 1 }}</p> <!-- Display billing address number -->
                <form action="{{ url_for('update_billing', billing_index=index) }}" method="post">
                    <div class="form-group">
                        <label for="new_billing_address{{ index }}">Billing Address <span style="color: red;">*</span></label>
                        <textarea class="form-control" id="new_billing_address{{ index }}" name="new_billing_address{{ index }}" rows="4">{{ billing_address.billing_address }}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="new_card_nickname{{ index }}">Card Name <span style="color: red;">*</span></label>
                        <input type="text" class="form-control" id="new_card_nickname{{ index }}" name="new_card_nickname{{ index }}" value="{{ billing_address.card_nickname }}" >
                    </div>
                    <div class="form-group">
                        <label for="new_card_number{{ index }}">Card Number <span style="color: red;">*</span></label>
                        <input type="text" class="form-control" id="new_card_number{{ index }}" name="new_card_number{{ index }}" value="{{ billing_address.card_number }}" >
                    </div>
                    <div class="form-group">
                        <label for="new_expiry_date{{ index }}">Expiry Date <span style="color: red;">*</span></label>
                        <input type="text" class="form-control" id="new_expiry_date{{ index }}" name="new_expiry_date{{ index }}" value="{{ billing_address.expiry_date }}" placeholder="MM/YY" >
                    </div>
                    <div class="form-group">
                        <label for="new_cvv{{ index }}">CVV <span style="color: red;">*</span></label>
                        <input type="text" class="form-control" id="new_cvv{{ index }}" name="new_cvv{{ index }}" value="{{ billing_address.cvv }}" >
                    </div>
                <div class="form-group submit-btn">
                    <button href="#BA_from" type="submit" class="btn btn-primary">Update</button>
                    <button type="submit" formaction="{{ url_for('delete_billing', billing_index=index) }}" class="btn btn-danger">Delete</button>
                </div>
              </form>
              {% endfor %}
              </div>
              
            {% if billing_addresses_enum %}
                {% for index, billing_address in billing_addresses_enum %}
                    
                    <div class="col-lg-6 py-3 wow fadeInRight" >
                        <div class="bill-item">
                        <span class="subhead">Your Billing Addresses</span>
                        <!-- <h2 class="title-section">Break Language Boundaries with Akuru GEN</h2> -->
                        <div class="divider"></div>

                        <p><strong>Billing Address:</strong> {{ billing_address.billing_address }} </p>
                        <p><strong>Card Nickname:</strong> {{ billing_address.card_nickname }}</p>
                        <p><strong>Card Number:</strong> {{ billing_address.card_number }}</p>
                        <p><strong>Expiry Date:</strong> {{ billing_address.expiry_date }}</p>
                    </div>
                    <br>
                {% endfor %}
            {% else %}
                <div class="col-lg-12 py-3">
                    <p>No billing addresses found.</p>
                </div>
            {% endif %}
        </div>
        </div> <!-- .row -->
    </div> <!-- .container -->
</div> <!-- .page-section -->


<div class="page-section" id="BA_from">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 py-3 wow fadeInLeft">
                <div class="img-fluid py-3 text-center">
                    <img src="{{ url_for('static', filename='img/about_frame.png') }}" alt="">
                </div>
            </div>
            {% if billing_addresses_enum %}
                {% for index, billing_address in billing_addresses_enum %}
                    
                    <div class="col-lg-6 py-3 wow fadeInRight">
                        <span class="subhead">Your Billing Addresses</span>
                        <h2 class="title-section"><p><strong>Billing Address No:</strong> {{ index + 1 }}</p> <!-- Display billing address number --></h2>
                        <div class="divider"></div>

                        <p><strong>Billing Address:</strong> {{ billing_address.billing_address }} </p>
                        <p><strong>Card Nickname:</strong> {{ billing_address.card_nickname }}</p>
                        <p><strong>Card Number:</strong> {{ billing_address.card_number }}</p>
                        <p><strong>Expiry Date:</strong> {{ billing_address.expiry_date }}</p>
                          <!-- Update and Delete Buttons -->
                          <div class="form-group submit-btn">
                            <!-- Add the download button/link below -->
                            <a href="{{ url_for('download_billing_pdf') }}" class="btn btn-success">Download Billing Addresses Report</a>
                          </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="col-lg-12 py-3">
                    <p>No billing addresses found.</p>
                </div>
            {% endif %}
            
        </div> <!-- .row -->
    </div>
</div>
</div> <!-- .container -->
</div> <!-- .page-section -->


<footer class="page-footer bg-image" style="background-image: url(../assets/img/);">
    <div class="container">
      <div class="row mb-5">
        <div class="col-lg-3 py-3">
          <h5><span class="text-primary">අකුරු </span>GEN</h5>
          <p>Experience Seamless Sinhala-English Communication! SEES translation with Akuru GEN. Our AI powered platform is designed to provide</p>
          <div class="social-media-button">
            <a href="#"><span class="mai-logo-facebook-f"></span></a>
            <a href="#"><span class="mai-logo-twitter"></span></a>
            <a href="#"><span class="mai-logo-google-plus-g"></span></a>
            <a href="#"><span class="mai-logo-instagram"></span></a>
            <a href="#"><span class="mai-logo-youtube"></span></a>
          </div>
        </div>
        <div class="col-lg-3 py-3">
          <h5>Company</h5>
          <ul class="footer-menu">
            <li><a href="#">About Us</a></li>
            <li><a href="#">Career</a></li>
            <li><a href="#">Advertise</a></li>
            <li><a href="#">Terms of Service</a></li>
            <li><a href="#">Help & Support</a></li>
          </ul>
        </div>
        <div class="col-lg-3 py-3">
          <h5>Contact Us</h5>
          <p>3671 Whispymound Drive, Vinewood Hills, Los Santos, San Andreas California, USA</p>
          <a href="#" class="footer-link">+00 1122 3344 5566</a>
          <a href="#" class="footer-link">akurugen@Support.gmail.com</a>
        </div>
        <div class="col-lg-3 py-3">
          <h5>Newsletter</h5>
          <p>Get updates, news or events on your mail.</p>
          <form action="#">
            <input type="text" class="form-control" placeholder="Enter your email..">
            <button type="submit" class="btn btn-success btn-block mt-2">Subscribe</button>
          </form>
        </div>
      </div>

      <p class="text-center" id="copyright">Copyright &copy; 2024. Design and develop by <a href="https://www.linkedin.com/in/thamindusulakshana/">අකුරු GEN</a></p>
    </div>
    
  </footer>
  <div>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }}" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    {% endwith %}
</div>
  <script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/google-maps.js') }}"></script>
  <script src="{{ url_for('static', filename='vendor/wow/wow.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
  <script>
    // Function to validate card number
    function validateCardNumber(cardNumber) {
return /^\d{16}$/.test(cardNumber);
}

// Function to detect card type
function detectCardType(cardNumber) {
if (/^4/.test(cardNumber)) {
    return 'visa';
} else if (/^5[1-5]/.test(cardNumber)) {
    return 'mastercard';
} else {
    return 'unknown';
}
}

// Function to validate expiry date
function validateExpiryDate(expiryDate) {
return /^(0[1-9]|1[0-2])\/\d{2}$/.test(expiryDate);
}

// Function to validate CVV
function validateCVV(cvv) {
return /^\d{3}$/.test(cvv);
}

document.addEventListener('DOMContentLoaded', function() {
// Select input fields
const cardNumberInput = document.getElementById('card_number');
const expiryDateInput = document.getElementById('expiry_date');
const cvvInput = document.getElementById('cvv');

// Select feedback spans
const cardNumberFeedback = document.getElementById('card-number-feedback');
const expiryDateFeedback = document.getElementById('expiry-date-feedback');
const cvvFeedback = document.getElementById('cvv-feedback');

// Function to update feedback
function updateFeedback(input, feedback, isValid, hint) {
    if (isValid) {
        input.classList.remove('is-invalid');
        input.classList.add('is-valid');
        feedback.innerHTML = '';
    } else {
        input.classList.remove('is-valid');
        input.classList.add('is-invalid');
        feedback.innerHTML = `<div class="invalid-feedback">Invalid input. ${hint}</div>`;
    }
}

// Event listeners for input fields
cardNumberInput.addEventListener('input', function() {
    const isValid = validateCardNumber(this.value);
    const cardType = detectCardType(this.value);
    const hint = 'Please enter a 16-digit card number.';
    updateFeedback(this, cardNumberFeedback, isValid, hint);
    // Display card icon based on card type
    const cardIcon = document.getElementById('card-icon');
    if (cardType === 'visa') {
        cardIcon.className = 'fab fa-cc-visa text-success';
    } else if (cardType === 'mastercard') {
        cardIcon.className = 'fab fa-cc-mastercard text-success';
    } else {
        cardIcon.className = '';
    }
});

expiryDateInput.addEventListener('input', function() {
    // Add slash automatically after 2 characters
    if (this.value.length === 2 && !this.value.includes('/')) {
        this.value += '/';
    }
    const isValid = validateExpiryDate(this.value);
    const hint = 'Please enter a valid expiry date in MM/YYYY format.';
    updateFeedback(this, expiryDateFeedback, isValid, hint);
});

cvvInput.addEventListener('input', function() {
    const isValid = validateCVV(this.value);
    const hint = 'Please enter a 3-digit CVV.';
    updateFeedback(this, cvvFeedback, isValid, hint);
});
});
</script>


</body>
</html>